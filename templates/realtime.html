<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Real-Time Fish Detection</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --bg-color-video: #ffffff; /* Light mode background */
      }

      body.dark-mode {
        --bg-color-video: #333333; /* Dark mode background */
      }

      body {
        font-family: "Poppins", sans-serif;
        margin: 0;
        padding: 0;
        background: #ffffff;
        color: #333333;
        display: flex;
        transition: background 0.3s ease, color 0.3s ease;
      }

      /* Dark Mode */
      body.dark-mode {
        background: linear-gradient(135deg, #1a1a1a, #2d2d2d);
        color: #f4f4f4;
      }

      .sidebar {
        width: 300px;
        background-color: #1f2327;
        color: white;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        display: flex;
        flex-direction: column;
        padding-top: 20px;
        transition: all 0.3s ease;
      }

      .sidebar a {
        color: white;
        text-decoration: none;
        margin: 8px 20px;
        padding: 15px 30px;
        display: flex;
        align-items: center;
        font-size: 16px;
        border-radius: 12px;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        background: linear-gradient(
          135deg,
          rgba(201, 37, 37, 0.1) 0%,
          rgba(201, 37, 37, 0.05) 100%
        );
        border: 1px solid rgba(201, 37, 37, 0.1);
        font-weight: 700;
      }

      .sidebar a i {
        margin-right: 15px;
        font-size: 20px;
        transition: all 0.3s ease;
      }

      /* Hover effect */
      .sidebar a:hover {
        transform: translateX(15px) scale(1.03);
        background: linear-gradient(
          135deg,
          rgba(201, 37, 37, 0.2) 0%,
          rgba(201, 37, 37, 0.15) 100%
        );
        box-shadow: 0 4px 15px rgba(201, 37, 37, 0.2);
        border: 1px solid rgba(201, 37, 37, 0.2);
        z-index: 2;
      }

      .sidebar a:hover i {
        transform: translateX(3px);
        color: #ff4d4d;
      }

      /* Active state */
      .sidebar a.active {
        background: linear-gradient(
          135deg,
          rgba(201, 37, 37, 0.3) 0%,
          rgba(201, 37, 37, 0.2) 100%
        );
        border: 1px solid rgba(201, 37, 37, 0.3);
        box-shadow: 0 4px 15px rgba(201, 37, 37, 0.15);
        transform: translateX(10px);
        z-index: 3;
      }

      /* Main Content */
      .main {
        margin-left: 320px;
        padding: 20px;
        display: flex;
        gap: 20px;
        justify-content: center;
        align-items: center;
      }

      .detection-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        max-width: 600px;
      }

      .detection-container h1 {
        font-size: 24px;
        font-weight: 700;
        margin-bottom: 20px;
      }

      video,
      canvas {
        width: 100%;
        max-width: 600px;
        height: 400px;
        border: 2px solid #ddd;
        border-radius: 10px;
        margin-bottom: 20px;
        background: var(--bg-color-video); /* Use variable for background */
      }

      button {
        background: linear-gradient(135deg, #c92525, #e13939);
        color: white;
        border: none;
        padding: 15px 30px;
        border-radius: 25px;
        font-size: 18px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      button:hover {
        background: linear-gradient(135deg, #e13939, #ff4d4d);
        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        transform: translateY(-2px);
      }

      /* Results Area */
      .results-container {
        flex: 1;
        background: #f2f2f2;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        width: 100%;
        max-width: 600px;
      }

      .results-container h2 {
        font-size: 20px;
        margin-bottom: 10px;
      }

      #frameDetectionResult {
        white-space: pre-wrap;
        background: #e0e0e0;
        color: #333;
        padding: 10px;
        border-radius: 5px;
        font-family: "Courier New", monospace;
        height: 350px;
        overflow-y: auto;
      }

      body.dark-mode .results-container {
        background: #3c3c3c;
      }

      body.dark-mode #frameDetectionResult {
        background: #333333;
        color: #f4f4f4;
      }

      /* Dark Mode Toggle */
      #theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 56px;
        height: 28px;
        border-radius: 9999px;
        background-color: white;
        cursor: pointer;
        box-shadow: 0 4px 15px -1px rgba(0, 0, 0, 0.1);
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1000; /* Ensure it stays above other elements */
      }

      #slider {
        position: absolute;
        top: 4px;
        left: 4px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        background-color: #c92525;
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .toggle-icon {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }

      #sun-icon {
        right: 8px;
        color: #c92525;
      }

      #moon-icon {
        left: 8px;
        opacity: 0;
        color: #ffffff;
      }

      body.dark-mode #theme-toggle {
        background-color: #3c3c3c;
      }

      body.dark-mode #slider {
        background-color: #ffffff;
        transform: translateX(28px);
      }

      body.dark-mode #sun-icon {
        opacity: 0;
      }

      body.dark-mode #moon-icon {
        opacity: 1;
      }
    </style>
  </head>
  <body>
    <!-- Dark Mode Toggle -->
    <div id="theme-toggle">
      <div id="slider"></div>
      <i id="moon-icon" class="fa-solid fa-sun toggle-icon"></i>
      <i id="sun-icon" class="fa-solid fa-moon toggle-icon"></i>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <a href="/page2">Dashboard</a>
      <a href="/page2">Scan Now</a>
    </div>

    <!-- Main Content -->
    <div class="main">
      <!-- Detection Area -->
      <div class="detection-container">
        <h1>Fish Freshness Real-Time Detection</h1>
        <video id="frameVideo" autoplay muted></video>
        <canvas id="frameCanvas" style="display: none"></canvas>
        <button id="startDetection">Start Detection</button>
      </div>

      <!-- Results Area -->
      <div class="results-container">
        <h2>Detection Results</h2>
        <pre id="frameDetectionResult">
Detection results will appear here...</pre
        >
      </div>
    </div>

    <script>
      // Function to enable dark mode
      function enableDarkMode() {
        document.body.classList.add("dark-mode");
        localStorage.setItem("theme", "dark"); // Save preference
      }

      // Function to disable dark mode
      function disableDarkMode() {
        document.body.classList.remove("dark-mode");
        localStorage.setItem("theme", "light"); // Save preference
      }

      // Check saved theme on load
      window.addEventListener("DOMContentLoaded", () => {
        const savedTheme = localStorage.getItem("theme");
        if (savedTheme === "dark" || !savedTheme) {
          enableDarkMode(); // Default to dark if no preference
        } else {
          disableDarkMode();
        }
      });

      // Toggle theme on button click
      const themeToggle = document.getElementById("theme-toggle");
      themeToggle.addEventListener("click", () => {
        if (document.body.classList.contains("dark-mode")) {
          disableDarkMode();
        } else {
          enableDarkMode();
        }
      });

      // Simplified labels with colors for quality
      const simplifiedLabels = {
        "BANGUS - Spoiled": { label: "BANGUS (Spoiled)", color: "#FF5733" },
        "BANGUS - Extremely Fresh": {
          label: "BANGUS (Extremely Fresh)",
          color: "#33FF57",
        },
        "BANGUS - Fresh": { label: "BANGUS (Fresh)", color: "#3357FF" },
        "EYE - Unacceptable": { label: "EYES (Spoiled)", color: "#FF33A1" },
        "EYE - Prime Quality": {
          label: "EYES (Prime Quality)",
          color: "#00FF7F",
        },
        "SKIN - Spoiled": { label: "SKIN (Spoiled)", color: "#800000" },
        "SKIN - Prime Quality": {
          label: "SKIN (Prime Quality)",
          color: "#D2691E",
        },
      };

      function displayResults(data) {
        const resultContainer = document.getElementById("frameDetectionResult");
        resultContainer.innerHTML = ""; // Clear previous results

        if (data.predictions && data.predictions.length > 0) {
          const overallHeader = document.createElement("h3");
          overallHeader.textContent = "OVERALL:";
          overallHeader.style.color = "#FFFFFF"; // Header in white
          resultContainer.appendChild(overallHeader);

          data.predictions.forEach((prediction) => {
            let simplifiedClass = prediction.class
              .replace(/-?\s?\d+(\sto\s\d+)?\s?-?/g, "")
              .trim();

            const classInfo = simplifiedLabels[simplifiedClass] || {
              label: simplifiedClass,
              color: "#FFFFFF", // Default to white if not mapped
            };

            const confidenceScore = (prediction.confidence * 100).toFixed(2);
            const labelDiv = document.createElement("div");

            labelDiv.style.marginBottom = "10px";
            labelDiv.style.color = classInfo.color;
            labelDiv.innerHTML = `
              <strong>${classInfo.label}</strong> - Confidence ${confidenceScore}%
            `;

            resultContainer.appendChild(labelDiv);
          });
        } else {
          resultContainer.textContent = "No predictions found.";
        }
      }
    </script>
  </body>
</html>
